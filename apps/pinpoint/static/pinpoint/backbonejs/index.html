<!DOCTYPE html>
<html lang="en">
    <head>
        <title>BackboneJS Gap Landing Page</title>
        <!-- CSS -->
        <noscript><style> .no-noscript { display: none } </style></noscript>
        <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
        <link rel="stylesheet" type="text/css" href="css/pages2.css" />
        <link rel="stylesheet" type="text/css" href="css/styles.css" />
        <!-- End CSS -->
        <meta name="viewport" content="user-scalable=no,width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1"><!-- required by bootstrap -->
        <meta http-equiv="X-UA-Compatible" content="IE=edge"><!-- required by bootstrap, IE -->
    </head>

    <body>
        <header>
            <nav class="navbar navbar-fixed-top navbar-static-top" role="navigation">
                <!-- collapsible -->
                <!-- div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand brand-label" href="#"></a>
                </div>

                <div class="collapse navbar-collapse navbar-ex1-collapse" -->

                <!-- non-collapsible -->
                <div class="container">
                    <ul class="nav navbar-nav"><!-- RHS: .navbar-right -->
                        <li><a class="navbar-brand brand-label" href="#"></a></li>
                        <!-- li class="active"><a href="#">Home</a></li -->
                        <li class="dropdown hidden-md hidden-lg">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Other brands <b class="caret"></b></a>
                            <ul class="related-products dropdown-menu">
                                <li><a href="http://www.gap.com">Gap</a></li>
                                <li><a href="http://www.oldnavy.com">Old Navy</a></li>
                                <li><a href="http://www.bananarepublic.com">Banana Republic</a></li>
                                <li><a href="http://www.piperlime.com">Piperlime</a></li>
                                <li><a href="http://www.athleta.com">Athleta</a></li>
                            </ul>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle"
                               data-toggle="dropdown">Categories <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="#" data-category="96">Back to Blue</a></li>
                                <li><a href="#" data-category="99">Samsung SSD</a></li>
                            </ul>
                        </li>
                    </ul>
                    <ul class="nav navbar-nav navbar-right hidden-xs">
                        <li class="sharing">
                            Stay Connected:
                            <ul>
                                <li class="icon pinterest">
                                    <a href="http://www.pinterest.com/Gap"
                                       target="_blank">&nbsp;</a>
                                </li>
                                <li class="icon facebook">
                                    <a href="http://www.facebook.com/Gap"
                                       target="_blank">&nbsp;</a>
                                </li>
                                <li class="icon twitter">
                                    <a href="http://www.twitter.com/gap"
                                       target="_blank">&nbsp;</a>
                                </li>
                                <li class="icon instagram">
                                    <a href="http://www.instagram.com/gap"
                                       target="_blank">&nbsp;</a>
                                </li>
                                <li class="icon youtube">
                                    <a href="http://www.youtube.com/Gap"
                                       target="_blank">&nbsp;</a>
                                </li>
                                <li class="icon tumblr">
                                    <a href="http://gap.tumblr.com"
                                       target="_blank">&nbsp;</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div><!-- /.navbar-collapse -->
            </nav>
        </header>
        <div class="container"><!-- .container is bootstrap magic, and has a viewport-dependent width. -->
            <!-- remove contents of hero-area if it is dynamically generated -->
            <div id="hero-area" class="featured">
                <div class="visible-xs jumbotron"><!-- hero unit (mobile 1) -->
                    <!-- configure hero images by overriding its background -->
                </div>
                <div class="visible-sm jumbotron"><!-- hero unit (mobile 2) -->
                    <!-- configure hero images by overriding its background -->
                </div>
                <div class="visible-md visible-lg jumbotron"><!-- hero unit (desktop) -->
                    <!-- configure hero images by overriding its background -->
                </div>
            </div>
            <div id="discovery-area" class="discovery-area">
                <!-- paste pre-rendered tiles here (TODO... event handling for them) -->
            </div>
            <div class="no-noscript loading"></div>
            <noscript>
                <!-- promotions to show when user does not have javascript.
                     this is a 'we need javascript' message by default.
                 -->
                <div class="alert alert-danger">
                    <b>Oh no!</b> We need JavaScript enabled to show you this page.
                </div>
            </noscript>
        </div>


        <!-- Templates -->
        <script type="text/template" id="disabled_featured_template">
            <div class='featured product'>
                <!-- Main Display Area -->
                <img class='img-responsive pull-left' src='<%= obj.image %>' />
                <div class='pull-right'><%= obj.title %></div>
                    <div class='price'><%= obj.price %></div>
                    <div>
                        <a href='<%= obj.url %>' target='_blank'>BUY NOW</a>
                    </div>
                </div>
            </div>

            <div class='spacer'></div>
        </script>

        <script type="text/template" id="product_tile_template">
            <div class="tap-indicator-target"></div>
            <img class="focus" src="<%= obj.image %>" alt="<%= caption %>" />
            <% if (SecondFunnel.option('debug', 0) > 1) { %>
                <span class="type"><%= obj['content-type'] %></span>
            <% } %>
            <div class="social-buttons"></div>
        </script>
        <script type="text/template" id="product_mobile_tile_template">
            <div class="tap-indicator-target"></div>
            <img class="focus" src="<%= obj.image %>" alt="<%= caption %>" />
            <% if (SecondFunnel.option('debug', 0) > 1) { %>
                <span class="type"><%= obj['content-type'] %></span>
            <% } %>
            <% if (obj.name) { %>
                <div class="caption">
                    <span><%= obj.name.truncate(40, false, true) %></span>
                </div>
            <% } %>
            <div class="social-buttons"></div>
        </script>
        <script type="text/template" id="youtube_tile_template">
            <div class="img-responsive thumbnail"
                 style="background-image: url('<%= obj.thumbnail || obj.image %>');">
              &nbsp;
              <img src="" alt="this img tag intentionally left blank" style="visibility:hidden"/>
            </div>
            <%= obj.caption || obj.name %>
            <div class="social-buttons"></div>
        </script>
        <script type="text/template" id="preview_container_template">
            <div class="tablecell">
                <div class="content">
                    <span class="close">&#x00D7;</span>
                    <div class="scrollable">
                        <div class="template target"></div>
                    </div>
                </div>
            </div>
            <div class="mask"></div>
        </script>
        <script type="text/template" id="tile_preview_template">
            <h2><span class="label label-info"><%= obj.template %>_preview_template</span> is missing.</h2>
            <p>You can define one in <code>index.html</code>.</p>
            <ul>
                <% for (i in obj) { %>
                    <li><b><%= i %></b>: <%= obj[i] %></li>
                <% } %>
            </ul>
        </script>
        <script type="text/template" id="tap_indicator_template">
            +
            <div>
                <%= SecondFunnel.option('tapIndicatorText', 'tap to see more') %>
            </div>
        </script>
        <script type="text/template" id="facebook_social_button_template">
            <div class='button facebook'>
                <img src="//s3-us-west-2.amazonaws.com/static-misc-secondfunnel/images/fb-like-0.png" alt="Like" class="placeholder" />
                <fb:like href="<%= url %>" width="48" layout="button_count"
                         show_faces="false"></fb:like>
            </div>
        </script>
        <script type="text/template" id="twitter_social_button_template">
            <% if (showCount) { %>
                <div class='button twitter' style='height: 13px; width: 77px;'>
                    <a href="https://twitter.com/share?url=<%= url %>"
                       class="twitter-share-button"
                       data-lang="en" data-height= "15">
                      Tweet
                    </a>
                </div>
            <% } else { %>
                <div class='button twitter'>
                    <a href="https://twitter.com/share?url=<%= url %>" target="_blank">
                        <img src="//elasticbeanstalk-us-east-1-056265713214.s3.amazonaws.com/pinpoint/images/twitterButton.png"/>
                    </a>
                </div>
            <% } %>
        </script>
        <script type="text/template" id="pinterest_social_button_template">
            <div class='button pinterest'>
                <a href="http://pinterest.com/pin/create/button/?url=<%= url %>&media=<%= image %>"
                   target="_blank"><img src="//elasticbeanstalk-us-east-1-056265713214.s3.amazonaws.com/pinpoint/images/pinpointButton.png"/></a>
            </div>
        </script>
        <script type="text/template" id="reddit_social_button_template">
            <div class="button reddit">
                <a href="http://www.reddit.com/submit"
                   onclick="window.location = 'http://www.reddit.com/submit?url=<%= url %>'; return false"
                  ><img src="http://www.reddit.com/static/spreddit7.gif"
                       alt="submit to reddit"
                       border="0" /></a>
            </div>
        </script>
        <script type="text/template" id="tumblr_social_button_template">
            <div class="button tumblr">
                <a href="http://www.tumblr.com/share/photo?source=<%= url %>&caption=<%= caption %>&click_thru=<%= url %>"
                     target='_blank'><img src="http://platform.tumblr.com/v1/share_1.png"/></a>
            </div>
        </script>
        <script type="text/template" id="share_social_button_template">
            <div class="button share-this">
                <a href=""><img src="//s3-us-west-2.amazonaws.com/static-misc-secondfunnel/images/Sharethis-draft1.png"
                                alt="Share this" border="0" /></a>
            </div>
        </script>
        <script type="text/template" id="share_popup_template">
            <div class="mask"></div>
            <div class="tablecell">
                <div class="content">
                    <span class="close">&#x00D7;</span>
                    <h2> Share This </h2>
                    <div class="share"></div>
                </div>
            </div>
        </script>
        <script type="text/template" id="share_popup_option_template">
            <a href="<%= url %>" target="_blank">
                <div style="position: relative;">
                    <div class="share_img"></div>
                    <span class="share_text"><%= text %></span>
                </div>
            </a>
        </script>
        <script type="text/template" id="product_preview_template">
            <img src="<%= obj.image %>" alt=""/>
            <%= obj.price %>
            <div class="social-buttons"></div>
        </script>
        <script type="text/template" id="image_preview_template">
            <h4>
                <span class="label label-info"><%= obj.template %></span>
                <%= obj.caption || obj.title || obj.name %>
                <!-- in that order (it may still have none of those) -->
            </h4>
            <img src="<%= obj.image %>" alt=""/>
            <div class="social-buttons"></div>
        </script>




        <!-- store-specific templates -->
        <script type="text/template" id="gap_product_preview_template">
            <!-- any (store.name)_(type)_... templates will be used in place
                 of default templates if they exist. -->
            <div class='content-wrapper row'>
                <div class='image-div col-sm-6 col-md-6'>
                    <div class='image'>
                        <img class='img-rounded' src='<%= sizeImage(obj.image, 400) %>'/>
                    </div>
                </div>
                <div class='info col-sm-6 col-md-6'>
                    <div class='title'><%= obj.title %></div>
                    <div class='red marker price'><%= obj.price %></div>
                    <div class='description'>
                        <div class='desc-title'>Overview</div>
                        <ul>
                            <% var sentences = _.compact(obj.description.split('.')); %>
                            <% _.each(sentences, function(sentence) { %>
                                <li><%= SecondFunnel.utils.safeString(sentence) %></li>
                            <% }); %>
                        </ul>
                    </div>
                    <div>
                        <div class="social-buttons"></div>
                        <div class='spacer'></div>
                    </div>
                    <div class='gap-buttons'>
                        <a class='button find-store' href='http://www.gap.com/customerService/storeLocator.do' target='_blank'>
                            <!-- find-store is magic -->
                            Find in Store
                        </a>
                        <a class='button in-store' href='<%= obj.url %>' target='_blank'>
                            <!-- in-store is magic -->
                            Shop on Gap.com
                        </a>
                    </div>
                    <% if(obj.images.length >1) { %>
                        <div class='gallery'></div>
                    <% } %>
                </div>
            </div>
        </script>
        <script type="text/template" id="gap_image_preview_template">
            <!-- any (store.name)_(type)_... templates will be used in place
                 of default templates if they exist. -->
            <%
                // > console.log(obj);
                // caption: " "
                // content-id: 562949953426705
                // content-type: "Instagram"
                // db-id: 5393
                // image: "http://images.secondfunnel.com/store/gap/lifestyle/b127ff7bd36c348c8de82c8951f30ff1/master.gif"
                // original-id: "tumblr_mra6qu7uh11s6ofheo1_500"
                // related-products: [{
                //     "product-id": 19387,
                //     "description": "Long sleeves with button cuffs. Collar. Button front. Button patch pockets, buttonhole pen slot.",
                //     "title": "1969 chambray shirt",
                //     "url": "http://www.gap.com/browse/product.do?pid=350489002",
                //     "price": "$59.95",
                //     "tags": {
                //         "campaign": "99"
                //     },
                //     "db-id": 19387,
                //     "template": "product",
                //     "images": ["http://images.secondfunnel.com/store/gap/product/19387/image/0eaa9c2e36ade25c6c6985f50c54fe09/master.jpg"],
                //     "image": "http://images.secondfunnel.com/store/gap/product/19387/image/0eaa9c2e36ade25c6c6985f50c54fe09/master.jpg"
                // }]
                // template: "instagram"
                // tile-id: 562949953426705
            %>
            <% if (obj['related-products'].length) { %>
                <div class="image-with-related-products">
                    <div class="row">
                        <div class="image col-sm-6 col-md-6">
                            <img class='img-rounded' src="<%= sizeImage(obj.image, 400) %>" alt="image" />
                        </div>
                        <div class="col-sm-6 col-md-6">
                            <% var product = obj['related-products'][0]; %>
                            <div class='title'><%= product.title %></div>
                            <div class='price'><%= product.price %></div>
                            <img class="main-image" src="<%= sizeImage(product.image, 150) %>" alt="related product" />
                            <div class='description'>
                                <div class='desc-title'>Overview</div>
                                <ul>
                                    <% var sentences = _.compact(product.description.split('.')); %>
                                    <% _.each(sentences, function(sentence) { %>
                                        <li><%= SecondFunnel.utils.safeString(sentence) %></li>
                                    <% }); %>
                                </ul>
                            </div>
                            <div>
                                <div class="social-buttons"></div>
                                <div class='spacer'></div>
                            </div>
                            <div class='gap-buttons'>
                                <a class='button find-store' href='http://www.gap.com/customerService/storeLocator.do' target='_blank'>
                                    Find in Store
                                </a>
                                <a class='button in-store' href='<%= product.url %>' target='_blank'>
                                    Shop on Gap.com
                                </a>
                            </div>
                            <% if (product.images.length > 1) { %>
                                <div class='gallery'></div>
                            <% } %>
                        </div>
                    </div>
                </div>
            <% } else { %>
                <div class="image-without-related-products">
                    <img src="<%= sizeImage(obj.image, 400) %>" alt="image" />
                    <div class="info">
                        <%= SecondFunnel.utils.safeString(obj.caption) %>
                        <span class="label label-info pull-right"><%= obj.template %></span>
                    </div>
                </div>
            <% } %>
        </script>


        <!-- End Templates -->
        <!-- Javascript Files -->
        <script type="text/javascript">
            window.PAGES_INFO = {
                'debug': 0,
                'base_url': "http://www.secondfunnel.com",
                'discoveryTarget': "#discovery-area",
                'discoveryItemSelector': ".tile",
                'store': {
                    'id': "38",
                    'name': "gap",
                    'displayName': ""  // leave blank to use "Gap"
                },
                'page': {  // required
                    'id': 9001,  // required
                    'offline': false  // optional (if true, loads .content immediately)
                },
                'campaign': 96,
                'categories': [
                    {  // you will still need to make elements with data-category="96" on the page.
                        'id': 96
                    },
                    {
                        'id': 97
                    },
                    {
                        'id': 98
                    },
                    {
                        'id': 99
                    }
                ],
                'columnWidth': function($element) {
                    return 240 + 15;
                },
                'events': undefined,  // page event bindings (optional)
                'socialButtons': [
                    "facebook",
                    "twitter",
                    "pinterest",
                    "tumblr",
                    "share"  // who requested this feature?
                 ], // optional
                //'shareSocialButtons': [], // optional; default: all
                'shareSources': {},  // optional: default: see sharing module
                'socialButtonsEnableCondition': function (button) {
                    // required.
                    // this function must return true for a social button to show
                    // and return false for a social button not to show
                    return true;
                },
                'showCount': false,  // for social buttons
                'enableTracking': true, // optional; default: true
                'eventMap': undefined,  // optional
                'tileElement': undefined,  // optional. alters the type of tag used by tiles.
                'imageTileWide': 0.25,
                'imageSizes': undefined,  // optional, overrides built-in size map
                'previewAnimationDuration': 100,  // in ms
                'previewMobileAnimationDuration': 0,
                'masonryAnimationDuration': 0.4,  // in seconds
                'masonryMobileAnimationDuration': 0,
                'featured': { // the featured product
                    "tile-id": 19325,
                    "content-id": 19325,
                    "name": "1969 ankle-zip legging skimmer jeans",
                    "title": "1969 ankle-zip legging skimmer jeans",
                    "url": "http://www.gap.com/browse/product.do?pid=600011002",
                    "price": "$69.95",
                    "tags": {
                        "": "",
                        "campaign": "99"
                    },
                    "db-id": 19325,
                    "template": "product",
                    "images": ["http://images.secondfunnel.com/store/gap/product/19325/image/54681ad98adb419528b985b73b8f21e2/master.jpg", "http://images.secondfunnel.com/store/gap/product/19325/image/41d0864dd5f98c7f23a58a6c7ce47c09/master.jpg", "http://images.secondfunnel.com/store/gap/product/19325/image/a2b381e086cfdd2aa6ea748940fafc5d/master.jpg"],
                    "image": "http://images.secondfunnel.com/store/gap/product/19325/image/54681ad98adb419528b985b73b8f21e2/master.jpg",
                    "id": "19325",
                    "description": "Fabrication: Premium stretch knit. Hardware: Button closure, zip fly. Features: Five-pocket styling. Zipper detailing at coin pocket and ankle backs.\nCut: Mid-rise with a shorter length. Fit: Skinny through the hip and thigh. Leg opening: Skinny. Inseams: regular: 28\", tall: 32\", petite: 26\""
                },
                'initialResults': [  // stuff that loads when page loads, even if IR is available
                    {
                        'caption': "None",
                        'content-id': 562949953426705,
                        'content-type': "Instagram",
                        'db-id': 5393,
                        'image': "http://images.secondfunnel.com/store/gap/lifestyle/b127ff7bd36c348c8de82c8951f30ff1/master.gif",
                        'original-id': "tumblr_mra6qu7uh11s6ofheo1_500",
                        'template': "instagram",
                        'tile-id': 562949953426705
                    }
                ],
                'IRResultsCount': 10,
                'IRTimeout': 5000,
                'IRSource': "http://intentrank-test.elasticbeanstalk.com/intentrank", // optional, defaults to intentrank-test
                'gaAccountNumber': 'UA-65432-1',  // UA-65432-1 is not a real account

                // number of viewports worth of results to keep below the page.
                // 0 is not an acceptable value, but 0.0001 is. default is 1,
                // i.e. there will always be one page worth of results
                // underneath, no matter how fast you scroll.
                'prefetchHeight': 1,

                'lockWidth': true,  // must be true (not 1, {}, ...) or a function that returns true
                'desiredWidth': 1024,

                'backupResults': [
                    // stuff that loads when IR doesn't respond within PAGES_INFO.IRTimeout.
                    // it really should contain at least 10 products.
                ]
            };

            var _gaq = _gaq || [];

            if (window.location.hostname === 'localhost' ||
                window.location.hostname === '127.0.0.1') {
                _gaq.push(['_setDomainName', 'none']);
            }

            _gaq.push(['_setAccount', window.PAGES_INFO.gaAccountNumber]);

            _gaq.push(['_setCustomVar',
                1,                               // slot id
                'StoreID',                       // name
                window.PAGES_INFO.store.id,  // value
                3                                // scope: page-level
            ]);

            _gaq.push(['_setCustomVar', 2, 'CampaignID',
                window.PAGES_INFO.campaign,  // <int>
                3
            ]);

            _gaq.push(['_trackPageview']);
        </script>
        <!-- Social -->
        <div id="fb-root"></div>
        <!-- End Social -->
        <script type="text/javascript" src="//connect.facebook.net/en_US/all.js"></script>
        <script type="text/javascript" src="js/respond.min.js"></script><!-- "as early after the css as possible" -->
        <script type="text/javascript" src="js/jquery.min.js"></script>
        <script type="text/javascript" src="js/jquery.mobile.swipeonly.min.js"></script>
        <script type="text/javascript" src="js/jquery.viewport.min.js"></script><!-- after jquery -->
        <script type="text/javascript" src="js/json2.js"></script>
        <script type="text/javascript" src="js/underscore.js"></script>
        <script type="text/javascript" src="js/backbone.js"></script>
        <script type="text/javascript" src="js/backbone.marionette.min.js"></script><!-- after backbone -->
        <script type="text/javascript" src="js/imagesloaded.pkgd.min.js"></script>
        <script type="text/javascript" src="js/jquery.masonry.pkgd.min.js"></script>
        <script type="text/javascript" src="js/jquery.masonry.extensions.js"></script>
        <script type="text/javascript" src="js/bootstrap.min.js"></script>
        <script type="text/javascript" src="js/pages.marionette.preinit.js"></script><!-- after marionette -->
        <script type="text/javascript" src="js/pages.marionette.js"></script><!-- after preinit -->
        <script type="text/javascript" src="js/pages.marionette.observable.js"></script><!-- after marionette -->
        <script type="text/javascript" src="js/pages.marionette.tracker.js"></script><!-- after marionette -->
        <script type="text/javascript" src="js/pages.marionette.layoutengine.js"></script><!-- after marionette -->
        <script type="text/javascript" src="js/pages.marionette.sharing.js"></script><!-- after marionette -->
        <script type="text/javascript" src="js/pages.marionette.ir.js"></script><!-- after marionette -->
        <script type="text/javascript" src="js/pages.marionette.viewport.js"></script><!-- after pages -->
        <script type="text/javascript" src="js/pages.marionette.init.js"></script><!-- after pages -->
        <script type="text/javascript" src="js/pages.marionette.widget.gallery.js"></script>
        <script type="text/javascript" src="js/css3-mediaqueries.js"></script><!-- IE8 -->
        <script type="text/javascript">
            if (window.SecondFunnel) {
                // Start the SecondFunnel app
                SecondFunnel.start(SecondFunnel.options);
                window.sizeImage = SecondFunnel.utils.pickImageSize;  // export for designers

                // Example: add UI events
                new SecondFunnel.classRegistry.EventManager({
                    'click .navbar-brand': function (ev) {
                        console.log('bur... custom event triggered');
                    }
                });

                // Example: handle right hand side link clicks
                new SecondFunnel.classRegistry.EventManager({
                    'click .navbar-right a': function (ev) {
                        var $ev = $(ev.currentTarget);

                        console.log('Click detected! ' + $ev.attr('href'));
                    }
                });


                // Example: receive event notifications
                receive({
                    'previewRendered': function () {
                        console.log('doh! preview rendered');
                    }
                });
            }
        </script>
        <!-- End Javascript -->
    </body>
</html>
