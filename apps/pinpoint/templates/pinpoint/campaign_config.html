{% load staticfiles %}

<script type="text/javascript">
    window.PAGES_INFO = {
          'debug': ('{{ debug|default:0 }}' === 'True')  // django built-in
        // , 'base_url': '{{ base_url }}'  // DEPRECATED
        , 'discoveryTarget': '{{ discovery_target|default:"#discovery-area" }}'
        , 'itemSelector': '{{ item_selector|default:".tile" }}'
        , 'store': {
            'id': '{{ store.id }}',
            'slug': '{{ store.slug|default:"store" }}',  // required for store-specific themes
            'name': '{{ store.name|default:"Store" }}',
            'displayName': '{{ store.display_name|default:'' }}'  // leave blank to use "Gap"
        }
        , 'page': {  // required
            'id': '{{ campaign.intentrank_id|default:campaign.id }}'  // required
            , 'product': {{ product }}
            , 'pubDate': '{{ pub_date }}'  // for verifying the original upload date of a static campaign. for human use only
            , 'offline': false  // optional (if true, loads .content immediately)

            , 'name': '{{ campaign.name|default:"" }}'  // provided by campaign manager
            , 'slug': '{{ campaign.url_slug|default:"" }}'

            , 'layout': '{{ campaign.layout|default:"hero" }}'  // provided by campaign manager

            // you will still need to make elements with data-category="96" on the page.
            , 'categories': {{ campaign.categories|default:"[]"|safe }}  // string representation of [{id: 123, name: 'gap'}, ...]

            // 'main-block-template': '{{ campaign.template }}',  // DEPRECATED
            // 'SHUFFLE_RESULTS': {{ campaign.shuffle_results|default:'true' }},  // DEPRECATED
            // 'stl-image': '{{ campaign.stl_image }}',  // DEPRECATED
            // 'featured-image': '{{ campaign.featured_image }}',  // DEPRECATED
            , 'description': "{{ campaign.description|escapejs }}"
        }
        , 'campaign': '{{ campaign.intentrank_id|default:campaign.id }}' // required
        , 'columnWidth': {{ column_width|default:'undefined' }}  // optional. controls how often tiles are wide.  // optional (defaults to 255, pixels)
        , 'dynamicColumns': {{ campaign.dynamic_columns|default:"false" }}
        , 'maxColumnCount': {{ campaign.column_count|default:4 }}  // optional (default: 4)
        // , 'events': undefined  // page event bindings (optional)
        , 'disableBannerRedirectOnMobile': {{ campaign.disable_banner_redirect_on_mobile|default:"false" }}
        , 'socialButtons':
            {% if social_buttons %}
                {{ social_buttons|safe }}{# social-buttons must be a json array of strings -- see below #}
            {% else %}
                [
                    "facebook",
                    "twitter",
                    "pinterest",
                    "tumblr",
                    "share"  // who requested this feature?
                ]
            {% endif %}
        // , 'shareSocialButtons': []  // optional; default: all
        // , 'shareSources': {}  // optional: default: see sharing module
        , 'socialButtonsEnableCondition': function (button) {
            // required.
            // this function must return true for a social button to show
            // and return false for a social button not to show
            return true;
        }
        , 'conditionalSocialButtons': {{ conditional_social_buttons|safe }}
        , 'categories': [] // a list of categories to allow filtering on
        , 'categoryHome': true // a string or boolean indicating if there should be a home button/what the home button should be
        , 'showCount': true  // optional, for social buttons (default: true)
        , 'enableTracking': {{ enable_tracking|default:"true" }}  // optional; default: true
        // , 'eventMap': undefined  // optional
        // , 'tileElement': undefined  // optional. alters the type of tag used by tiles.
        , 'imageTileWide': {{ image_tile_wide }}  // optional. controls how often tiles are wide.
        // , 'imageSizes': undefined  // optional, overrides built-in size map
        , 'minImageWidth': {{ campaign.minImageWidth|default:255 }} // minimum width a Cloudinary image can have
        , 'minImageHeight': {{ campaign.minImageHeight|default:100 }} // minimum height a Cloudinary image can have
        // , 'tapIndicatorText': undefined,  // optional
        , 'previewAnimationDuration': 100  // in ms
        , 'previewMobileAnimationDuration': 0
        , 'masonry': {  // passed to masonry
            'transitionDuration': 0.4,  // in seconds
            'minColumns': {{ campaign.masonry.minColumns|default:2 }} // minimum number of columns for masonry
        }
        , 'featured': {{ product }}
        // stuff that loads when page loads, even if IR is available
        , 'IRResultsCount': 10
        , 'IRTimeout': 5000
        // , 'IRFailuresAllowed': undefined  // optional. defaults to 5
        , 'IRSource': "{{ campaign.ir_base_url|default:ir_base_url }}"  // optional
        , 'IRAlgo': "{{ algorithm|default:"generic" }}"  // optional
        , 'IRReqNum': 0  // optional
        , 'IROffset': 0
        , 'gaAccountNumber': '{{ campaign.ga_account_number|default:ga_account_number }}'  // required
        , 'keen': {
            'projectId': '{{ keen_io.projectId }}',
            'writeKey': '{{ keen_io.writeKey }}'
        }
        // number of viewports worth of results to keep below the page.
        // 0 is not an acceptable value, but 0.0001 is. default is 1.5,
        // i.e. there will always be one page worth of results
        // underneath, no matter how fast you scroll.
        // , 'prefetchHeight': undefined

        // , 'lockWidth': undefined  // must be true (not 1, {}, ...) or a function that returns true. undefined means auto.
        // , 'desiredWidth': 0,  // number, or a function that returns a number. 0 means auto.

        , 'resultsThreshold': {{ campaign.results_threshold|default:"undefined"|safe }}  // {[tileId: num,]}

        , 'initialResults': [
            {% for result in initial_results %}
                {{ result }}
                {% if not forloop.last %},{% endif %}
            {% endfor %}
        ]
        // stuff that loads when IR doesn't respond within PAGES_INFO.IRTimeout.
        // it really should contain at least 10 products.
        , 'backupResults': [
            {% for result in backup_results %}
                {{ result }}
                {% if not forloop.last %},{% endif %}
            {% endfor %}
        ]
    };

</script>
