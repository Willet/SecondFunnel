{% load staticfiles %}
{% load compress %}
<!-- Head Contents -->
<noscript><style> .no-noscript { display: none } </style></noscript>
<!-- Begin Javascript -->
<!-- Preload images -->
<script type="text/javascript">
    // Preload images
    var images = [ "{{ desktop_hero_image }}", "{{ mobile_hero_image }}" ];
    for (var i = 0; i < images.length; ++i) {
        if (images[i].length) {
            (new Image).src = images[i];
        }
    }
</script>
<!-- End Preload -->
{% include "pinpoint/campaign_config.html" %}
<script type="text/javascript">
    (function() {
        // http://stackoverflow.com/questions/8567114/how-to-make-an-ajax-call-without-jquery
        // Initial call to IR
        if ((!PAGES_INFO.IRReqNum) || (PAGES_INFO.IRReqNum === undefined)) {
            PAGES_INFO.IRReqNum = 0;
        }

        if (!(PAGES_INFO.initialResults && PAGES_INFO.initialResults.length)) {
            // Support for IE6/5 in the event that XMLHttpRequest doesn't exist
            var xmlhttp, data;
            xmlhttp = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP");
            xmlhttp.open("GET", "{{ campaign.ir_base_url|default:ir_base_url }}/page/{{ campaign.intentrank_id|default:campaign.id }}/getresults?results=10&algorithm={{ algorithm }}&related={{ related_to_tile }}&reqNum=0", true);

            xmlhttp.onload = function () {
                // Ensures that it's resolved on 200 or 404
                if (xmlhttp.status === 200) { // success so resolve normally
                    PAGES_INFO.IRReqNum++;
                    PAGES_INFO.initialResults = JSON.parse(xmlhttp.response || xmlhttp.responseText);
                }
            };
            PAGES_INFO.initialResults = xmlhttp;
            xmlhttp.send();
        }
    })();
</script>
<!--[if gte IE 9]><!-->
{% compress js %}
   {% include "pinpoint/campaign_js.html" %}
{% endcompress %}
<!--<![endif]-->

<!--[if lte IE 8]>
{% compress js %}
   {% include "pinpoint/campaign_js.html" %}
{% endcompress %}
<![endif]-->

<script type="text/javascript">
      var lazyLoad;
      lazyLoad = setInterval(function() {
          if (window.App && document.getElementById('discovery-area')) {
              clearInterval(lazyLoad);
              App.start();
          }
      }, 100);
</script>
<!-- End Javascript -->

<!--Begin CSS-->
{% compress css %}
<link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.min.css' %}" />
<link rel="stylesheet" type="text/css" href="{% static 'pinpoint/css/pages2.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'pinpoint/css/5col.css' %}">
{% endcompress css %}

<!--[if IE 8]>
{% compress css %}
<link rel="stylesheet" type="text/css" href= {% static 'pinpoint/css/ie8.css' %}
{% endcompress css %}
<![endif]-->

<!-- End CSS -->
<script src='//cdn.secondfunnel.com/static-misc-secondfunnel/js/respond.min.js'></script>
<!-- Respond.js proxy on external server -->
<link href="//cdn.secondfunnel.com/cross-domain/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/static/images/cross-domain/respond.proxy.gif"  alt="do not change to %static% tag" id="respond-redirect" rel="respond-redirect" />
<script src="/static/js/cross-domain/respond.proxy.js" alt="do not change to %static% tag"></script>

<meta name="viewport" content="user-scalable=no,width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1"><!-- required by bootstrap -->
<meta http-equiv="X-UA-Compatible" content="IE=edge"><!-- required by bootstrap, IE -->
<script type="text/javascript" src="//connect.facebook.net/en_US/all.js" async></script>
